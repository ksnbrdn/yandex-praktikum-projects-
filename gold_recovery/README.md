# Восстановление золота из руды  
Было проведено исследование, чтобы подготовить прототип модели машинного обучения для компании «Цифра». Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды.  
Модель должна помогать оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.  
В нашем распоряжении данные с параметрами добычи и очистки. Данные находятся в трёх файлах, общие данные изначально разделены на тренировочный и тестовый файлы. Количество столбцов и строк у всех таблиц разное. Явные дупликаты отсутствуют. В некоторых столбцах есть пропущенные значения.  
По гистограмам выявлено, что большинство признаков имеют нормальное распределение, но встречаются и скошенные распределения. Также у некоторых признаков присутсвуют выбросы.  
Была рассчитана эффективность обогащения. Вычислили её на обучающей выборке для признака rougher.output.recovery. Нашли MAE между нашими расчётами и значением признака. Полученное значение МАЕ - 9.735. Можно сделать вывод, что эффективность обогащения рассчитана правильно.  
Выявили, что тестовой выборке отсутствуют целевые признаки 'rougher.output.recovery', 'final.output.recovery', а также значения output на разных этапах для различных металлов. Это фактические данные, которые получают только по факту реальных измерений. output значения не являются необходимыми для обучения и тестирования модели машинного обучения.  
В ходе работы была выполнена предобработка данных.  
Заполнили пропуски, используя метод ffill() - значения заменяются данными из предыдущего столбца или строки. Добавили в data_test столбцы 'final.output.recovery' и 'rougher.output.recovery'. Признаки 'date' в каждой таблице не несут ценности для обучения будущей модели, поэтому мы их удалили.    
В ходе работы был выполнен анализ данных.  
Посмотрели как меняется концентрация Au, Ag, Pb на разных этапах очистки. Доля золота на после каждого этапа очитски постепенно увеличивается. Доля серебра увеличивается на этапе флотации, а затем постепенно уменьшается. Доля свинца сначала увеличивается на этапе флотации и после первичной очитски, затем остатется примерно на одном уровне.  
Сравнили распределения размеров гранул сырья на обучающей и тестовой выборках. График распределение гранул сырья по размерам показывает, что размеры гранул существенно не различаются в тренировочной и тестовой выборках. Следовательно, оценка модели должна быть правильной.  
Построили гистаграмму распределения суммарных концентраций веществ: в сырье, в черновом и финальном концентратах. Все распределения концентраций веществ на различных стадиях показывают аномальные значения при нуле. Удалили выбросы из выборок, чтобы обеспечить точность будущей модели.  
Написали функцию для вычисления итоговой sMAPE. Удалили столбцы из data_train, которые не нужны для дальнейшего обучения модели. Разобили данные data_train и data_test на признаки и целевой признак, сохранили в отдельных переменных. Чтобы алгоритмам было легче обучать модели, привели признаки к одному масштабу с помощью метода стандартизации данных.  
Были обучены модели DecisionTreeRegressor, RandomForestRegressor и LinearRegression и оценили их качество кросс-валидацией. Для каждой модели был посчитан smape. Лучшая модель - RandomForestRegressor с показателем smape - 8.117, с лучшим значением n_estimators = 41 и лучшим значением max_depth = 4.  
Применили лучшую модель на тестовой выборке, smape для тестовой выборки - 9.153.  
Проверили полученную модель на адекватность, используя модель DummyRegressor. smape модели DummyRegressor выше, чем у нашей лучшей модели RandomForestRegressor. Наша модель адекватна и эффективна.Подготовка модели, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды на онове данных с параметрами добычи и очистки.     

## Используемые библиотеки  
- pandas
- numpy
- seaborn
- matplotlib.pyplot
- sklearn
- tqdm
